#include "xqc_tp_test.h"
#include "xqc_common_test.h"
#include "src/crypto/xqc_transport_params.h"

#include <CUnit/CUnit.h>

/* transport parameter from server */
#define XQC_TEST_TP_BUF "\x44\xd4\x08\x8c\x46\xe0\xc9\x1b\x81\x88\x22\x05" \
"\x04\x80\x08\x00\x00\x06\x04\x80\x08\x00\x00\x07\x04\x80\x08\x00" \
"\x00\x04\x04\x80\x0c\x00\x00\x08\x02\x40\x64\x09\x02\x40\x64\x01" \
"\x04\x80\x00\x75\x30\x03\x02\x45\xac\x0b\x01\x1a\x0c\x00\x02\x10" \
"\xeb\x46\xd4\xff\xd2\x14\x26\xe4\xea\x6f\x84\xd8\xcd\x6b\xf5\xa1" \
"\x00\x08\x0b\xf7\xbe\xf4\x06\x7a\xa1\xb7\x0e\x01\x04\x0f\x04\xec" \
"\x86\xa2\xa7\x20\x01\x00"

void
xqc_test_decode_transport_params()
{
    xqc_connection_t *conn = test_engine_connect();
    CU_ASSERT(conn != NULL);

    xqc_int_t ret = xqc_on_client_recv_peer_transport_params(conn, XQC_TEST_TP_BUF, sizeof(XQC_TEST_TP_BUF) - 1);
    CU_ASSERT(ret == XQC_OK);
}
